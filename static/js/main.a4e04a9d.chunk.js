(this["webpackJsonpgraph-editor-demo"]=this["webpackJsonpgraph-editor-demo"]||[]).push([[0],[,,,,,,function(t,e,a){t.exports={control:"Control_control__28owh",scale:"Control_scale__1q0Q-",rotate:"Control_rotate__1XCjm","control-selected":"Control_control-selected__nlVSh"}},,,,,function(t,e,a){t.exports={rect:"Rect_rect__2CUC7"}},function(t,e,a){t.exports={layer:"Layer_layer__39BI3"}},function(t,e,a){t.exports={canvas:"Canvas_canvas__1B2Ic"}},function(t,e,a){t.exports=a(20)},,,,,function(t,e,a){},function(t,e,a){"use strict";a.r(e);var n={};a.r(n),a.d(n,"rect",(function(){return g}));var r=a(0),c=a.n(r),o=a(10),s=a.n(o),i=(a(19),a(2)),u=a(1),l=a(4),d=a(3),f=a(11),h=a.n(f),b=c.a.forwardRef((function(t,e){var a=t.width,n=void 0===a?100:a,r=t.height,o=void 0===r?100:r,s=Object(l.a)(t,["width","height"]);return c.a.createElement("div",Object.assign({},s,{className:Object(d.a)(h.a.rect),ref:e,style:{width:n,height:o}}))}));b.displayName="Rect";var v=b;function g(t){var e,a;return{width:null!==(e=t.width)&&void 0!==e?e:0,height:null!==(a=t.height)&&void 0!==a?a:0}}function p(t,e){var a=Math.acos(-e/Math.sqrt(Math.pow(t,2)+Math.pow(e,2)));return t>0?a:-a}function m(t,e,a){return[Math.cos(a)*t-Math.sin(a)*e,Math.sin(a)*t+Math.cos(a)*e]}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,a=0;return function(){var n=Date.now();n-a>e&&(t.apply(void 0,arguments),a=n)}}function O(t){return Object.keys(t).map((function(e){return"".concat(e,"(").concat(t[e],")")})).join(" ")}function j(t){var e=Object(r.useRef)(t);return Object(r.useEffect)((function(){e.current=t}),[t]),e}var w=a(12),x=a.n(w),S={rect:v},M=c.a.forwardRef((function(t,e){var a=t.type,o=t.x,s=t.y,i=t.rotate,u=t.scaleX,f=t.scaleY,h=t.attributes,b=t.className,v=Object(l.a)(t,["type","x","y","rotate","scaleX","scaleY","attributes","className"]),g=Object(r.useMemo)((function(){return n[a](h)}),[a,h]),p=g.width,m=g.height,y=S[a];return c.a.createElement("div",Object.assign({},v,{className:Object(d.a)(x.a.layer,b),ref:e,style:{width:p,height:m,transform:O({translate:"".concat(o-p/2,"px, ").concat(s-m/2,"px"),rotate:"".concat(i,"deg"),scaleX:u,scaleY:f})}}),y&&c.a.createElement(y,h))}));M.displayName="Layer";var E=M,X=a(6),Y=a.n(X),k=[{top:0,left:"50%"},{top:0,left:"100%"},{top:"50%",left:"100%"},{top:"100%",left:"100%"},{top:"100%",left:"50%"},{top:"100%",left:0},{top:"50%",left:0},{top:0,left:0}],C=c.a.forwardRef((function(t,e){var a=t.width,n=t.height,o=t.x,s=t.y,i=t.rotate,f=t.scaleX,h=t.scaleY,b=t.onMoveStart,v=t.onScaleStart,g=t.onRotateStart,p=t.onMouseDown,m=t.scaleOnlyBoth,y=void 0!==m&&m,j=t.className,w=t.style,x=Object(l.a)(t,["width","height","x","y","rotate","scaleX","scaleY","onMoveStart","onScaleStart","onRotateStart","onMouseDown","scaleOnlyBoth","className","style"]),S=Object(r.useMemo)((function(){return Math.abs(a*f)}),[a,f]),M=Object(r.useMemo)((function(){return Math.abs(n*h)}),[n,h]);return c.a.createElement("div",Object.assign({className:Object(d.a)(Y.a.control,j),style:Object(u.a)(Object(u.a)({},w),{},{width:S,height:M,transform:O({translate:"".concat(o-S/2,"px, ").concat(s-M/2,"px"),rotate:"".concat(i,"deg")})}),ref:e,onMouseDown:function(t){null===b||void 0===b||b(t),null===p||void 0===p||p(t)}},x),k.map((function(t,e){var a=t.top,n=t.left;return y&&e%2===0?null:c.a.createElement("div",{className:Object(d.a)(Y.a.scale),key:e,style:{top:a,left:n,cursor:N(e,i)},onMouseDown:function(t){return null===v||void 0===v?void 0:v(t,e)}})})),c.a.createElement("div",{className:Object(d.a)(Y.a.rotate),onMouseDown:function(t){return null===g||void 0===g?void 0:g(t)}},c.a.createElement("span",{role:"img","aria-label":"rotate"},"\ud83d\udd03")))}));C.displayName="Control";var L=C,_=["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"];function N(t,e){for(var a=e;a<0;)a+=360;return _[(t+Math.round(a/45))%8%8]}var R=c.a.forwardRef((function(t,e){var a=t.type,o=t.x,s=t.y,i=t.rotate,f=t.scaleX,h=t.scaleY,b=t.attributes,v=t.className,g=t.style,p=Object(l.a)(t,["type","x","y","rotate","scaleX","scaleY","attributes","className","style"]),m=Object(r.useMemo)((function(){return n[a](b)}),[a,b]),y=m.width,j=m.height,w=Object(r.useMemo)((function(){return Math.abs(y*f)}),[y,f]),x=Object(r.useMemo)((function(){return Math.abs(j*h)}),[j,h]);return c.a.createElement("div",Object.assign({className:Object(d.a)(Y.a["control-selected"],v),style:Object(u.a)(Object(u.a)({},g),{},{width:w,height:x,transform:O({translate:"".concat(o-w/2,"px, ").concat(s-x/2,"px"),rotate:"".concat(i,"deg")})}),ref:e},p))}));R.displayName="ControlSelected";var P=R,z=a(13),I=a.n(z),B=a(5);function D(t){var e=t.type,a=t.attributes,r=t.scaleX,c=t.scaleY,o=n[e](a);return{width:o.width*r,height:o.height*c}}function U(t,e){return t.x+=e.x,t.y+=e.y,t.rotate+=e.rotate,t.scaleX*=e.scaleX,t.scaleY*=e.scaleY,t}function T(t,e,a){var n=t.x-a.x,r=t.y-a.y;n+=e.x,r+=e.y;var c=m(n*=e.scaleX,r*=e.scaleY,e.rotate*Math.PI/180),o=Object(i.a)(c,2);return n=o[0],r=o[1],n+=a.x-t.x,r+=a.y-t.y,Object(u.a)(Object(u.a)({},e),{},{x:n,y:r})}var q=["y","both","x","both"];var J=c.a.forwardRef((function(t,e){var a=t.layers,n=t.onUpdate,o=t.className,s=Object(l.a)(t,["layers","onUpdate","className"]),f=Object(r.useRef)(null);c.a.useImperativeHandle(e,(function(){return f.current}));var h=function(t){var e=Object(r.useState)(!1),a=Object(i.a)(e,2),n=a[0],c=a[1];return Object(r.useEffect)((function(){var e=function(e){e.key===t&&c(!0)},a=function(e){e.key===t&&c(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",a),function(){window.removeEventListener("keydown",e),window.removeEventListener("keyup",a)}}),[c,t]),n}("Shift"),b=function(){var t=Object(r.useState)([]),e=Object(i.a)(t,2),a=e[0],n=e[1],c=Object(r.useCallback)((function(t){n((function(e){return e.includes(t.id)?e:[].concat(Object(B.a)(e),[t.id])}))}),[n]),o=Object(r.useCallback)((function(t){n((function(e){return e.includes(t.id)?e.filter((function(e){return e!==t.id})):e}))}),[n]),s=Object(r.useCallback)((function(){n([])}),[n]);return{state:a,setState:n,add:c,remove:o,clear:s}}(),v=b.state,g=b.add,O=b.remove,w=b.clear,x=function(){var t=Object(r.useState)(null),e=Object(i.a)(t,2),a=e[0],n=e[1],c=Object(r.useCallback)((function(t,e){var a,r,c,o,s=t.filter((function(t){return e.includes(t.id)}));if(0===s.length)return n(null);if(1===s.length){var i=s[0],u=i.x,l=i.y,d=i.rotate,f=D(s[0]),h=f.width,b=f.height;return n({x:u,y:l,width:h,height:b,rotate:d,scaleX:1,scaleY:1})}s.forEach((function(t){var e,n,s,i,u=t.x,l=t.y,d=t.rotate,f=D(t),h=f.width,b=f.height,v={x1:-h/2,y1:-b/2,x2:h/2,y2:b/2},g=d*Math.PI/180,p=[m(v.x1,v.y1,g),m(v.x1,v.y2,g),m(v.x2,v.y1,g),m(v.x2,v.y2,g)];a=Math.min.apply(Math,[null!==(e=a)&&void 0!==e?e:1/0].concat(Object(B.a)(p.map((function(t){return t[0]+u}))))),r=Math.min.apply(Math,[null!==(n=r)&&void 0!==n?n:1/0].concat(Object(B.a)(p.map((function(t){return t[1]+l}))))),c=Math.max.apply(Math,[null!==(s=c)&&void 0!==s?s:-1/0].concat(Object(B.a)(p.map((function(t){return t[0]+u}))))),o=Math.max.apply(Math,[null!==(i=o)&&void 0!==i?i:-1/0].concat(Object(B.a)(p.map((function(t){return t[1]+l})))))})),n({x:(a+c)/2,y:(r+o)/2,width:c-a,height:o-r,rotate:0,scaleX:1,scaleY:1})}),[n]);return{state:a,setState:n,reset:c}}(),S=x.state,M=x.reset,X=function(){var t=Object(r.useState)({x:0,y:0,rotate:0,scaleX:1,scaleY:1}),e=Object(i.a)(t,2),a=e[0],n=e[1],c=Object(r.useRef)({changing:!1,changed:!1,baseX:0,baseY:0,startX:0,startY:0,scaleType:"both"}),o=Object(r.useCallback)((function(){return n({x:0,y:0,rotate:0,scaleX:1,scaleY:1})}),[n]);return{state:a,setState:n,reset:o,changing:c}}(),Y=X.state,k=X.changing,C=X.reset,_=Object(r.useCallback)((function(t){var e=f.current.getBoundingClientRect(),a=k.current;a.baseX=e.x,a.baseY=e.y}),[f,k]);Object(r.useEffect)((function(){C(),M(a,v)}),[M,C,a,v]);var N=function(t){var e=t.layers,a=t.selected,n=t.control,c=t.change,o=t.onUpdate,s=j(e),i=j(a),l=j(n),d=j(c),f=j(o);return{submit:Object(r.useCallback)((function(){var t,e=s.current,a=i.current,n=l.current,r=d.current;null===(t=f.current)||void 0===t||t.call(f,e.map((function(t){if(!a.includes(t.id))return t;var e=Object(u.a)({},t);return U(e,T(e,r,null!==n&&void 0!==n?n:{x:e.x,y:e.y})),e})))}),[s,i,l,d,f])}}({layers:a,selected:v,control:S,change:Y,onUpdate:n}).submit,R=function(t){var e=t.changeState,a=t.submit,n=e.changing,c=e.setState,o=Object(r.useCallback)(y((function(t){var e=n.current;e.changing&&(e.changed=!0,c((function(a){return Object(u.a)(Object(u.a)({},a),{},{x:t.pageX-e.startX,y:t.pageY-e.startY})})))}),16),[n,c]),s=Object(r.useCallback)((function(){window.removeEventListener("mousemove",o),n.current.changing=!1,a()}),[n,a,o]),i=Object(r.useCallback)((function(t){var e=n.current;e.changing=!0,e.changed=!1,e.startX=t.pageX,e.startY=t.pageY,window.addEventListener("mousemove",o),window.addEventListener("mouseup",s,{once:!0})}),[o,s,n]);return Object(r.useEffect)((function(){return function(){window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",s)}}),[o,s]),{onMoveStart:i}}({changeState:X,submit:N}).onMoveStart,z=function(t){var e=t.controlState,a=t.changeState,n=t.submit,c=e.state,o=a.changing,s=a.setState,i=j(c),l=Object(r.useCallback)(y((function(t){var e=o.current;if(e.changing&&i.current){e.changed=!0;var a=i.current,n=a.x,r=a.y,c={},l=(t.pageX-e.baseX-n)/(e.startX-e.baseX-n),d=(t.pageY-e.baseY-r)/(e.startY-e.baseY-r);switch(e.scaleType){case"x":c.scaleX=l;break;case"y":c.scaleY=d;break;default:Math.abs(l)>Math.abs(d)?(c.scaleX=l,c.scaleY=l):(c.scaleX=d,c.scaleY=d)}s((function(t){return Object(u.a)(Object(u.a)({},t),c)}))}}),16),[o,s]),d=Object(r.useCallback)((function(){window.removeEventListener("mousemove",l),o.current.changing=!1,n()}),[o,n,l]),f=Object(r.useCallback)((function(t,e){var a=o.current;a.changing=!0,a.changed=!1,a.startX=t.pageX,a.startY=t.pageY,a.scaleType=q[e%4],window.addEventListener("mousemove",l),window.addEventListener("mouseup",d,{once:!0})}),[l,d,o]);return Object(r.useEffect)((function(){return function(){window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",d)}}),[l,d]),{onScaleStart:f}}({controlState:x,changeState:X,submit:N}).onScaleStart,J=function(t){var e=t.controlState,a=t.changeState,n=t.submit,c=e.state,o=a.changing,s=a.setState,i=j(c),l=Object(r.useCallback)(y((function(t){var e=o.current;if(e.changing&&i.current){e.changed=!0;var a=i.current,n=a.x,r=a.y,c=(p(t.pageX-n,t.pageY-r)-p(e.startX-n,e.startY-r))/Math.PI*180;s((function(t){return Object(u.a)(Object(u.a)({},t),{},{rotate:c})}))}}),16),[o,s,i]),d=Object(r.useCallback)((function(){window.removeEventListener("mousemove",l),o.current.changing=!1,n()}),[o,n,l]),f=Object(r.useCallback)((function(t){var e=o.current;e.changing=!0,e.changed=!1,e.startX=t.pageX,e.startY=t.pageY,window.addEventListener("mousemove",l),window.addEventListener("mouseup",d,{once:!0})}),[l,d,o]);return Object(r.useEffect)((function(){return function(){window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",d)}}),[l,d]),{onRotateStart:f}}({controlState:x,changeState:X,submit:N}).onRotateStart;return c.a.createElement("div",Object.assign({className:Object(d.a)(I.a.canvas,o),ref:f,onClick:function(t){t.stopPropagation(),h||(k.current.changed?k.current.changed=!1:w())}},s),a.map((function(t){var e=t.id,a=Object(l.a)(t,["id"]);return S&&v.includes(e)&&U(a,T(t,Y,{x:S.x,y:S.y})),c.a.createElement(E,Object.assign({},a,{key:e,onClick:function(e){e.stopPropagation(),e.shiftKey||w(),g(t)}}))})),v.map((function(t){var e=a.find((function(e){return e.id===t}));if(!e)return null;e.id;var n=Object(l.a)(e,["id"]);return S&&v.includes(t)&&U(n,T(e,Y,{x:S.x,y:S.y})),c.a.createElement(P,Object.assign({},n,{key:t,onClick:function(t){t.stopPropagation(),t.shiftKey?O(e):(w(),g(e))},onMouseDown:function(t){t.stopPropagation(),_(t),R(t)}}))})),S&&c.a.createElement(L,Object.assign({style:{zIndex:h?-1:void 0}},U(Object(u.a)({},S),Y),{scaleOnlyBoth:v.length>1,onMoveStart:function(t){t.stopPropagation(),_(t),R(t)},onScaleStart:function(t,e){t.stopPropagation(),_(t),z(t,e)},onRotateStart:function(t){t.stopPropagation(),_(t),J(t)}})))}));J.displayName="Canvas";var K=J,H=[],Q=0;function V(t){H.push(Object(u.a)({id:"".concat(Q++),type:"rect",x:0,y:0,rotate:0,scaleX:1,scaleY:1},t))}V({type:"rect",x:400,y:100,rotate:30,attributes:{width:100,height:200}}),V({type:"rect",x:400,y:200,rotate:130,attributes:{width:100,height:200}}),V({type:"rect",x:400,y:200,scaleX:.5,scaleY:3,attributes:{width:200,height:100}}),V({type:"rect",x:300,y:300,scaleX:3,scaleY:.5,attributes:{width:200,height:100}}),V({type:"rect",x:300,y:100,attributes:{width:100,height:100}});for(var A=0;A<50;A+=1)V({type:"rect",x:10*A,y:10*A,attributes:{width:100,height:100}});var F=H;var G=function(){var t=Object(r.useState)(F),e=Object(i.a)(t,2),a=e[0],n=e[1];return c.a.createElement(K,{layers:a,onUpdate:n})};s.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(G,null)),document.getElementById("root"))}],[[14,1,2]]]);
//# sourceMappingURL=main.a4e04a9d.chunk.js.map